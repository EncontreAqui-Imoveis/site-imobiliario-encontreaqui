(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[724],{42:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>k});var r=a(5155),s=a(2115),i=a(63),l=a(2619),n=a.n(l),c=a(9408),d=a(6907),o=a(508),h=a(1847);let m=(0,h.A)("Megaphone",[["path",{d:"m3 11 18-5v12L3 14v-3z",key:"n962bs"}],["path",{d:"M11.6 16.8a3 3 0 1 1-5.8-1.6",key:"1yl0tm"}]]),x=(0,h.A)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);var y=a(5998),p=a(5993),u=a(7937),g=a(9559),f=a(1360),b=a(6132),v=a(5917),j=a(5380),N=a(960);function k(){let e=(0,i.useRouter)(),{isAuthenticated:t,isLoading:a}=(0,j.A)(),[l,h]=(0,s.useState)([]),[k,w]=(0,s.useState)(!0),[A,M]=(0,s.useState)(null),[_,C]=(0,s.useState)(!1);(0,s.useEffect)(()=>{a||t||e.push("/login?redirect=/notificacoes")},[t,a,e]);let S=async()=>{w(!0),M(null);try{let e=localStorage.getItem("token");if(!e)return void M("Sess\xe3o expirada. Fa\xe7a login novamente.");let t=await N.vx.getAll(e);if(t.error)return void M(t.error);let a=[],r=t.data;Array.isArray(r)?a=r:r&&"object"==typeof r&&(Array.isArray(r.data)?a=r.data:Array.isArray(r.notifications)&&(a=r.notifications)),h(a)}catch(e){console.error("Error fetching notifications:",e),M("Erro ao carregar notifica\xe7\xf5es.")}finally{w(!1)}};(0,s.useEffect)(()=>{t&&S()},[t]);let E=async e=>{try{let t=localStorage.getItem("token");if(!t)return;(await N.vx.markAsRead(e,t)).error||h(t=>t.filter(t=>t.id!==e))}catch(e){console.error("Error marking notification as read:",e)}},H=async()=>{if(!_&&0!==l.length){C(!0);try{let e=localStorage.getItem("token");if(!e)return;(await N.vx.markAllAsRead(e)).error||h([])}catch(e){console.error("Error marking all as read:",e)}finally{C(!1)}}},z=l.filter(e=>!e.is_read).length;return a?(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 pt-16 lg:pt-20 flex items-center justify-center",children:(0,r.jsx)("div",{className:"w-8 h-8 border-4 border-primary-500 border-t-transparent rounded-full animate-spin"})}):t?(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50 pt-16 lg:pt-20",children:[(0,r.jsx)("div",{className:"bg-white border-b border-gray-100",children:(0,r.jsxs)("div",{className:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[(0,r.jsxs)("nav",{className:"flex items-center gap-2 text-sm text-gray-500 mb-4",children:[(0,r.jsx)(n(),{href:"/",className:"hover:text-primary-500 transition-colors",children:(0,r.jsx)(p.A,{className:"w-4 h-4"})}),(0,r.jsx)(u.A,{className:"w-4 h-4"}),(0,r.jsx)("span",{className:"text-gray-900 font-medium",children:"Notifica\xe7\xf5es"})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsxs)("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-primary-600 to-primary-800 flex items-center justify-center shadow-lg relative",children:[(0,r.jsx)(y.A,{className:"w-6 h-6 text-white"}),z>0&&(0,r.jsx)("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white text-xs font-bold rounded-full flex items-center justify-center",children:z})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Notifica\xe7\xf5es"}),(0,r.jsx)("p",{className:"text-gray-500",children:l.length>0?"".concat(l.length," notifica\xe7\xe3o(\xf5es)"):"Nenhuma notifica\xe7\xe3o"})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("button",{onClick:S,disabled:k,className:"p-2 text-gray-400 hover:text-primary-500 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50",title:"Atualizar",children:(0,r.jsx)(g.A,{className:"w-5 h-5 ".concat(k?"animate-spin":"")})}),l.length>0&&(0,r.jsxs)("button",{onClick:H,disabled:_,className:"hidden sm:flex items-center gap-2 px-4 py-2 text-sm font-medium text-primary-600 hover:bg-primary-50 rounded-lg transition-colors disabled:opacity-50",children:[_?(0,r.jsx)("span",{className:"w-4 h-4 border-2 border-primary-500 border-t-transparent rounded-full animate-spin"}):(0,r.jsx)(f.A,{className:"w-4 h-4"}),"Limpar todas"]})]})]})]})}),(0,r.jsx)("div",{className:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:k?(0,r.jsx)("div",{className:"text-center py-16",children:(0,r.jsx)("div",{className:"w-10 h-10 border-4 border-primary-500 border-t-transparent rounded-full animate-spin mx-auto"})}):A?(0,r.jsxs)("div",{className:"text-center py-16 bg-white rounded-2xl border border-gray-100",children:[(0,r.jsx)("div",{className:"w-20 h-20 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,r.jsx)(b.A,{className:"w-10 h-10 text-red-500"})}),(0,r.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Erro ao carregar"}),(0,r.jsx)("p",{className:"text-gray-500 mb-4",children:A}),(0,r.jsx)("button",{onClick:S,className:"px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors",children:"Tentar novamente"})]}):l.length>0?(0,r.jsx)("div",{className:"space-y-3",children:l.map(e=>(0,r.jsx)("div",{className:"bg-white rounded-xl border p-4 transition-all ".concat(e.is_read?"border-gray-100":"border-primary-200 bg-primary-50/30"),children:(0,r.jsxs)("div",{className:"flex items-start gap-4",children:[(0,r.jsx)("div",{className:"w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0 ".concat(e.is_read?"bg-gray-100":"bg-white shadow"),children:(e=>{switch(e){case"property":return(0,r.jsx)(c.A,{className:"w-5 h-5 text-blue-500"});case"broker":return(0,r.jsx)(d.A,{className:"w-5 h-5 text-purple-500"});case"agency":return(0,r.jsx)(c.A,{className:"w-5 h-5 text-gray-500"});case"user":return(0,r.jsx)(o.A,{className:"w-5 h-5 text-gray-500"});case"announcement":return(0,r.jsx)(m,{className:"w-5 h-5 text-orange-500"});case"message":return(0,r.jsx)(x,{className:"w-5 h-5 text-green-500"});default:return(0,r.jsx)(y.A,{className:"w-5 h-5 text-gray-500"})}})(e.related_entity_type)}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"".concat(e.is_read?"text-gray-600":"text-gray-900 font-medium"),children:e.message}),(0,r.jsx)("p",{className:"text-xs text-gray-400 mt-2",children:(e=>{let t=new Date(e),a=new Date().getTime()-t.getTime(),r=Math.floor(a/6e4),s=Math.floor(a/36e5),i=Math.floor(a/864e5);return r<60?"H\xe1 ".concat(r," min"):s<24?"H\xe1 ".concat(s,"h"):1===i?"Ontem":i<7?"H\xe1 ".concat(i," dias"):t.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})})(e.created_at)})]}),(0,r.jsx)("button",{onClick:()=>E(e.id),className:"p-2 text-gray-400 hover:text-red-500 hover:bg-gray-100 rounded-lg transition-colors flex-shrink-0",title:"Marcar como lida",children:(0,r.jsx)(v.A,{className:"w-4 h-4"})})]}),"property"===e.related_entity_type&&e.related_entity_id&&(0,r.jsx)(n(),{href:"/imoveis/".concat(e.related_entity_id),className:"inline-block mt-3 text-sm font-medium text-primary-600 hover:text-primary-700",children:"Ver im\xf3vel â†’"})]})]})},e.id))}):(0,r.jsxs)("div",{className:"text-center py-16 bg-white rounded-2xl border border-gray-100",children:[(0,r.jsx)("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,r.jsx)(y.A,{className:"w-10 h-10 text-gray-400"})}),(0,r.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Nenhuma notifica\xe7\xe3o"}),(0,r.jsx)("p",{className:"text-gray-500",children:"Voc\xea n\xe3o tem notifica\xe7\xf5es no momento."})]})})]}):null}},508:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(1847).A)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},1360:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(1847).A)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},1727:(e,t,a)=>{Promise.resolve().then(a.bind(a,42))},5917:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(1847).A)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},5993:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(1847).A)("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]])},5998:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(1847).A)("Bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]])},6132:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(1847).A)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},6907:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(1847).A)("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},7937:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(1847).A)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},9408:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(1847).A)("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]])},9559:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(1847).A)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])}},e=>{e.O(0,[563,619,697,380,441,255,358],()=>e(e.s=1727)),_N_E=e.O()}]);