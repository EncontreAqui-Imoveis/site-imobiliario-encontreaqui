(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[435],{2529:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});let a=(0,t(1847).A)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},3664:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});let a=(0,t(1847).A)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},3935:(e,r,t)=>{"use strict";t.d(r,{J:()=>s,T:()=>c});var a=t(5155),i=t(2115);let o="registration_draft",n={name:"",email:"",password:"",phone:"",street:"",number:"",complement:"",bairro:"",city:"",state:"",cep:"",creci:""},l=(0,i.createContext)(void 0);function s(e){var r,t,s;let{children:c}=e,[d,u]=(0,i.useState)(null),[h,m]=(0,i.useState)(!0);(0,i.useEffect)(()=>{try{let e=localStorage.getItem(o);if(e){let r=JSON.parse(e);r.authData&&(r.authData.password=""),u(r)}}catch(e){console.error("Failed to load registration draft:",e),localStorage.removeItem(o)}finally{m(!1)}},[]);let f=(0,i.useCallback)(e=>{try{let r={...e,authData:{...e.authData,password:""},updatedAt:new Date().toISOString()};localStorage.setItem(o,JSON.stringify(r))}catch(e){console.error("Failed to persist registration draft:",e)}},[]),p=(0,i.useCallback)(e=>{u(r=>{var t,a,i,o,l,s;let c={step:null!=(a=null!=(t=e.step)?t:null==r?void 0:r.step)?a:"form",userType:null!=(o=null!=(i=e.userType)?i:null==r?void 0:r.userType)?o:"client",authData:{...null!=(l=null==r?void 0:r.authData)?l:n,...null!=(s=e.authData)?s:{}},updatedAt:new Date().toISOString()};return f(c),c})},[f]),v=(0,i.useCallback)(e=>{u(r=>{if(!r)return r;let t={...r,step:e,updatedAt:new Date().toISOString()};return f(t),t})},[f]),w=(0,i.useCallback)(e=>{u(r=>{if(!r)return r;let t={...r,authData:{...r.authData,...e},updatedAt:new Date().toISOString()};return f(t),t})},[f]),x=(0,i.useCallback)(()=>{localStorage.removeItem(o),u(null)},[]),g=(0,i.useCallback)(()=>null!==d&&"form"!==d.step,[d]),y={draft:d,isLoading:h,saveDraft:p,updateStep:v,updateAuthData:w,clearDraft:x,hasDraft:g,currentStep:null!=(r=null==d?void 0:d.step)?r:null,authData:null!=(t=null==d?void 0:d.authData)?t:null,userType:null!=(s=null==d?void 0:d.userType)?s:null};return(0,a.jsx)(l.Provider,{value:y,children:c})}function c(){let e=(0,i.useContext)(l);if(void 0===e)throw Error("useRegistration must be used within a RegistrationProvider");return e}},4585:(e,r,t)=>{"use strict";let a,i,o;t.d(r,{F0:()=>d,G6:()=>s,HW:()=>m,Tq:()=>c,gj:()=>h,i:()=>x,jW:()=>g,kH:()=>u,vC:()=>w,zE:()=>v});var n=t(2078),l=t(2553);try{a=(0,n.Dk)().length?(0,n.Sx)():(0,n.Wp)({apiKey:"AIzaSyDp2MfcERy2t6SdSODAxK1VqHgx2VSoM2o",authDomain:"encontreaqui-imoveis.firebaseapp.com",projectId:"encontreaqui-imoveis",storageBucket:"encontreaqui-imoveis.firebasestorage.app",messagingSenderId:"442509320982",appId:"1:442509320982:web:65b2b1c3a544c10d2d2637"}),i=(0,l.getAuth)(a),o=new l.GoogleAuthProvider}catch(e){console.error("Firebase initialization error:",e)}async function s(){try{let e=await (0,l.signInWithPopup)(i,o);return await e.user.getIdToken()}catch(e){if((null==e?void 0:e.code)==="auth/popup-closed-by-user"||(null==e?void 0:e.code)==="auth/cancelled-popup-request")return null;throw console.error("Google Sign-In Error:",e),Error("N\xe3o foi poss\xedvel fazer login com Google. Tente novamente.")}}async function c(e,r){try{return await (0,l.createUserWithEmailAndPassword)(i,e,r)}catch(e){if(console.error("Create User Error:",e),"auth/email-already-in-use"===e.code)throw Error("Este email j\xe1 est\xe1 cadastrado.");if("auth/weak-password"===e.code)throw Error("A senha deve ter pelo menos 6 caracteres.");if("auth/invalid-email"===e.code)throw Error("Email inv\xe1lido.");throw Error("Erro ao criar conta. Tente novamente.")}}async function d(e,r){try{return await (0,l.signInWithEmailAndPassword)(i,e,r)}catch(e){if(console.error("Sign In Error:",e),"auth/user-not-found"===e.code)throw Error("Usu\xe1rio n\xe3o encontrado.");if("auth/wrong-password"===e.code||"auth/invalid-credential"===e.code)throw Error("Senha incorreta.");if("auth/invalid-email"===e.code)throw Error("Email inv\xe1lido.");throw Error("Erro ao fazer login. Tente novamente.")}}async function u(){let e=i.currentUser;if(!e)throw Error("Nenhum usu\xe1rio logado.");try{await (0,l.sendEmailVerification)(e)}catch(e){if(console.error("Send Verification Email Error:",e),"auth/too-many-requests"===e.code)throw Error("Muitas tentativas. Aguarde alguns minutos.");throw Error("Erro ao enviar email de verifica\xe7\xe3o.")}}async function h(){let e=i.currentUser;if(!e)return!1;try{return await e.reload(),e.emailVerified}catch(e){return console.error("Refresh User Error:",e),!1}}function m(){return i.currentUser}let f=null,p=null;function v(e){if(f)try{f.clear()}catch(e){}return f=new l.RecaptchaVerifier(i,e,{size:"normal",callback:()=>{console.log("reCAPTCHA solved")},"expired-callback":()=>{console.log("reCAPTCHA expired")}})}async function w(e){if(!f)throw Error("Configure o reCAPTCHA primeiro.");try{return p=await (0,l.signInWithPhoneNumber)(i,e,f)}catch(e){if(console.error("Send SMS Error:",e),"auth/invalid-phone-number"===e.code)throw Error("N\xfamero de telefone inv\xe1lido.");if("auth/too-many-requests"===e.code)throw Error("Muitas tentativas. Aguarde alguns minutos.");if("auth/captcha-check-failed"===e.code)throw Error("Verifica\xe7\xe3o reCAPTCHA falhou. Tente novamente.");throw Error("Erro ao enviar SMS. Tente novamente.")}}async function x(e){if(!p)throw Error("Envie o SMS primeiro.");try{return await p.confirm(e)}catch(e){if(console.error("Verify SMS Error:",e),"auth/invalid-verification-code"===e.code)throw Error("C\xf3digo incorreto.");if("auth/code-expired"===e.code)throw Error("C\xf3digo expirado. Solicite um novo.");throw Error("Erro ao verificar c\xf3digo. Tente novamente.")}}function g(){if(f){try{f.clear()}catch(e){}f=null}p=null}},5177:(e,r,t)=>{Promise.resolve().then(t.bind(t,9880))},5626:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});let a=(0,t(1847).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},6132:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});let a=(0,t(1847).A)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},9559:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});let a=(0,t(1847).A)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},9880:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>v});var a=t(5155),i=t(2115),o=t(63),n=t(5239),l=t(2619),s=t.n(l),c=t(3664),d=t(6132),u=t(2529),h=t(9559),m=t(5626),f=t(3935),p=t(4585);function v(){var e;let r=(0,o.useRouter)(),{draft:t,updateStep:l,clearDraft:v}=(0,f.T)(),[w,x]=(0,i.useState)(!0),[g,y]=(0,i.useState)(!1),[b,E]=(0,i.useState)(!1),[j,S]=(0,i.useState)(!1),[k,A]=(0,i.useState)(null),[N,C]=(0,i.useState)(0),[I,T]=(0,i.useState)(""),D=(null==t||null==(e=t.authData)?void 0:e.email)||"",q=D?D.replace(/(.{2})(.*)(@.*)/,"$1***$3"):"";(0,i.useEffect)(()=>{let e=sessionStorage.getItem("registration_password")||"";if(T(e),!t||!D||!e)return void r.replace("/cadastro");x(!1)},[t,D,r]),(0,i.useEffect)(()=>{if(N<=0)return;let e=setInterval(()=>{C(e=>Math.max(0,e-1))},1e3);return()=>clearInterval(e)},[N]);let M=async()=>{if(!g&&!(N>0)){y(!0),A(null);try{var e,t,a;let i=(0,p.HW)();if(!i||(null==(e=i.email)?void 0:e.toLowerCase())!==D.toLowerCase())try{await (0,p.Tq)(D,I),i=(0,p.HW)()}catch(e){if((null==(t=e.message)?void 0:t.includes("j\xe1 est\xe1 cadastrado"))||"auth/email-already-in-use"===e.code)try{await (0,p.F0)(D,I),i=(0,p.HW)()}catch(e){if(null==(a=e.message)?void 0:a.includes("Senha incorreta"))throw Error('Este email j\xe1 est\xe1 cadastrado com outra senha. Use a op\xe7\xe3o "Esqueci minha senha" ou fa\xe7a login.');throw e}else throw e}if(!i)throw Error("Erro ao criar conta. Tente novamente.");if(i.emailVerified){l("phone_pending"),r.push("/cadastro/verificar-telefone");return}await (0,p.kH)(),S(!0),C(60)}catch(e){A(e.message||"Erro ao enviar email.")}finally{y(!1)}}},V=async()=>{if(!b){E(!0),A(null);try{await (0,p.gj)()?(l("phone_pending"),r.push("/cadastro/verificar-telefone")):A("Email ainda n\xe3o verificado. Clique no link enviado para seu email.")}catch(e){A(e.message||"Erro ao verificar status.")}finally{E(!1)}}};return w?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center gradient-hero",children:(0,a.jsx)("div",{className:"w-8 h-8 border-4 border-accent-500 border-t-transparent rounded-full animate-spin"})}):(0,a.jsx)("main",{className:"min-h-screen gradient-hero flex items-center justify-center px-4 py-12 pt-32",children:(0,a.jsxs)("div",{className:"relative z-10 w-full max-w-md",children:[(0,a.jsxs)("div",{className:"bg-white/10 backdrop-blur-xl rounded-3xl p-8 shadow-2xl border border-white/20",children:[(0,a.jsx)("div",{className:"flex justify-center mb-6",children:(0,a.jsx)(n.default,{src:"/logo2.svg",alt:"EncontreAqui",width:160,height:80,className:"h-20 w-auto",priority:!0})}),(0,a.jsxs)("div",{className:"text-center mb-6",children:[(0,a.jsx)(c.A,{className:"w-12 h-12 text-accent-400 mx-auto mb-3"}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-white mb-2",children:"Verificar Email"}),(0,a.jsx)("p",{className:"text-white/70",children:j?"Enviamos um link de verifica\xe7\xe3o para ".concat(q):"Vamos enviar um link de verifica\xe7\xe3o para ".concat(q)})]}),k&&(0,a.jsxs)("div",{className:"mb-6 p-4 bg-red-500/20 border border-red-500/30 rounded-xl flex items-start gap-3",children:[(0,a.jsx)(d.A,{className:"w-5 h-5 text-red-400 mt-0.5 flex-shrink-0"}),(0,a.jsx)("p",{className:"text-red-200 text-sm",children:k})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[j?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:V,disabled:b,className:"w-full py-4 bg-accent-500 hover:bg-accent-600 text-primary-900 font-semibold rounded-xl shadow-lg shadow-accent-500/25 transition-all duration-200 flex items-center justify-center gap-2 disabled:opacity-50",children:b?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"w-5 h-5 border-2 border-primary-900 border-t-transparent rounded-full animate-spin"}),"Verificando..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u.A,{className:"w-5 h-5"}),"J\xe1 Verifiquei"]})}),(0,a.jsx)("button",{onClick:M,disabled:g||N>0,className:"w-full py-3 bg-white/10 hover:bg-white/20 text-white font-medium rounded-xl border border-white/20 transition-all duration-200 flex items-center justify-center gap-2 disabled:opacity-50",children:N>0?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.A,{className:"w-4 h-4"}),"Reenviar em ",N,"s"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.A,{className:"w-4 h-4"}),"Reenviar Email"]})})]}):(0,a.jsx)("button",{onClick:M,disabled:g,className:"w-full py-4 bg-accent-500 hover:bg-accent-600 text-primary-900 font-semibold rounded-xl shadow-lg shadow-accent-500/25 transition-all duration-200 flex items-center justify-center gap-2 disabled:opacity-50",children:g?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"w-5 h-5 border-2 border-primary-900 border-t-transparent rounded-full animate-spin"}),"Enviando..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c.A,{className:"w-5 h-5"}),"Enviar Email de Verifica\xe7\xe3o"]})}),(0,a.jsxs)("button",{onClick:()=>{v(),r.push("/cadastro")},className:"w-full py-3 text-white/70 hover:text-white transition-colors flex items-center justify-center gap-2",children:[(0,a.jsx)(m.A,{className:"w-4 h-4"}),"Usar outro email"]})]}),(0,a.jsx)("div",{className:"mt-6 p-4 bg-white/5 rounded-xl border border-white/10",children:(0,a.jsx)("p",{className:"text-white/60 text-sm text-center",children:'N\xe3o recebeu o email? Verifique sua caixa de spam ou clique em "Reenviar Email".'})})]}),(0,a.jsxs)("p",{className:"text-center mt-6 text-white/70",children:["J\xe1 tem uma conta?"," ",(0,a.jsx)(s(),{href:"/login",className:"text-accent-400 hover:text-accent-300 font-medium",children:"Fazer login"})]})]})})}}},e=>{e.O(0,[563,619,697,239,441,255,358],()=>e(e.s=5177)),_N_E=e.O()}]);