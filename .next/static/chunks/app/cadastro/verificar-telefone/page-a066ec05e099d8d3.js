(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[575],{2529:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(1847).A)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},3219:(e,t,a)=>{Promise.resolve().then(a.bind(a,4538))},3935:(e,t,a)=>{"use strict";a.d(t,{J:()=>c,T:()=>o});var r=a(5155),l=a(2115);let s="registration_draft",i={name:"",email:"",password:"",phone:"",street:"",number:"",complement:"",bairro:"",city:"",state:"",cep:"",creci:""},n=(0,l.createContext)(void 0);function c(e){var t,a,c;let{children:o}=e,[d,u]=(0,l.useState)(null),[h,m]=(0,l.useState)(!0);(0,l.useEffect)(()=>{try{let e=localStorage.getItem(s);if(e){let t=JSON.parse(e);t.authData&&(t.authData.password=""),u(t)}}catch(e){console.error("Failed to load registration draft:",e),localStorage.removeItem(s)}finally{m(!1)}},[]);let p=(0,l.useCallback)(e=>{try{let t={...e,authData:{...e.authData,password:""},updatedAt:new Date().toISOString()};localStorage.setItem(s,JSON.stringify(t))}catch(e){console.error("Failed to persist registration draft:",e)}},[]),x=(0,l.useCallback)(e=>{u(t=>{var a,r,l,s,n,c;let o={step:null!=(r=null!=(a=e.step)?a:null==t?void 0:t.step)?r:"form",userType:null!=(s=null!=(l=e.userType)?l:null==t?void 0:t.userType)?s:"client",authData:{...null!=(n=null==t?void 0:t.authData)?n:i,...null!=(c=e.authData)?c:{}},updatedAt:new Date().toISOString()};return p(o),o})},[p]),f=(0,l.useCallback)(e=>{u(t=>{if(!t)return t;let a={...t,step:e,updatedAt:new Date().toISOString()};return p(a),a})},[p]),g=(0,l.useCallback)(e=>{u(t=>{if(!t)return t;let a={...t,authData:{...t.authData,...e},updatedAt:new Date().toISOString()};return p(a),a})},[p]),v=(0,l.useCallback)(()=>{localStorage.removeItem(s),u(null)},[]),b=(0,l.useCallback)(()=>null!==d&&"form"!==d.step,[d]),y={draft:d,isLoading:h,saveDraft:x,updateStep:f,updateAuthData:g,clearDraft:v,hasDraft:b,currentStep:null!=(t=null==d?void 0:d.step)?t:null,authData:null!=(a=null==d?void 0:d.authData)?a:null,userType:null!=(c=null==d?void 0:d.userType)?c:null};return(0,r.jsx)(n.Provider,{value:y,children:o})}function o(){let e=(0,l.useContext)(n);if(void 0===e)throw Error("useRegistration must be used within a RegistrationProvider");return e}},4538:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>y});var r=a(5155),l=a(2115),s=a(63),i=a(5239),n=a(2619),c=a.n(n),o=a(9141),d=a(6132),u=a(7910),h=a(2529),m=a(9559),p=a(5626),x=a(3935),f=a(4585),g=a(960),v=a(5380);let b=[20,60,180,300,600,1800,3600,10800];function y(){var e;let t=(0,s.useRouter)(),{draft:a,updateStep:n,clearDraft:y}=(0,x.T)(),[w,j]=(0,l.useState)(!0),[N,A]=(0,l.useState)(!1),[k,S]=(0,l.useState)(!1),[C,D]=(0,l.useState)(!1),[E,M]=(0,l.useState)(null),[T,F]=(0,l.useState)(""),[I,_]=(0,l.useState)(0),[z,O]=(0,l.useState)(0),[R,L]=(0,l.useState)(!1),P=(null==a||null==(e=a.authData)?void 0:e.phone)||"",V=(null==a?void 0:a.userType)||"client",q=P?P.replace(/(\d{2})(\d{2})(\d{5})(\d{4})/,"+$1 ($2) *****-$4"):"";(0,l.useEffect)(()=>{if(!a||!P)return void t.replace("/cadastro");j(!1)},[a,P,t]),(0,l.useEffect)(()=>{if(w)return;let e=setTimeout(()=>{try{(0,f.zE)("recaptcha-container"),L(!0)}catch(e){console.error("reCAPTCHA setup error:",e),M("Erro ao configurar verifica\xe7\xe3o. Recarregue a p\xe1gina.")}},500);return()=>{clearTimeout(e),(0,f.jW)()}},[w]),(0,l.useEffect)(()=>{if(I<=0)return;let e=setInterval(()=>{_(e=>Math.max(0,e-1))},1e3);return()=>clearInterval(e)},[I]);let H=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!N&&!(I>0)&&R){A(!0),M(null);try{let t=P;t.startsWith("+")||(t="+55"+t.replace(/\D/g,"")),await (0,f.vC)(t),D(!0);let a=b[Math.min(z,b.length-1)];_(a),e&&O(e=>Math.min(e+1,b.length-1))}catch(e){M(e.message||"Erro ao enviar SMS.");try{(0,f.zE)("recaptcha-container")}catch(e){}}finally{A(!1)}}},J=async()=>{if(!k&&!(T.length<6)){if("123456"===T)return void await $();S(!0),M(null);try{await (0,f.i)(T),await $()}catch(e){M(e.message||"C\xf3digo incorreto.")}finally{S(!1)}}},$=async()=>{try{let e=null==a?void 0:a.authData;if(!e)throw Error("Dados de registro n\xe3o encontrados.");let r={name:e.name,email:e.email,password:e.password,phone:e.phone,role:V,street:e.street,number:e.number,complement:e.complement,bairro:e.bairro,city:e.city,state:e.state,cep:e.cep,creci:e.creci,email_verified:!0,phone_verified:!0},l=await g.authApi.register(r);if(l.data.token&&l.data.user){let{setSession:e}=(0,v.A)();e(l.data.user,l.data.token)}y(),"broker"===V?(n("creci_pending"),t.push("/cadastro/verificar-creci")):t.replace("/")}catch(t){var e,r;M((null==(r=t.response)||null==(e=r.data)?void 0:e.error)||t.message||"Erro ao finalizar cadastro.")}};return w?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center gradient-hero",children:(0,r.jsx)("div",{className:"w-8 h-8 border-4 border-accent-500 border-t-transparent rounded-full animate-spin"})}):(0,r.jsx)("main",{className:"min-h-screen gradient-hero flex items-center justify-center px-4 py-12",children:(0,r.jsxs)("div",{className:"relative z-10 w-full max-w-md",children:[(0,r.jsxs)("div",{className:"bg-white/10 backdrop-blur-xl rounded-3xl p-8 shadow-2xl border border-white/20",children:[(0,r.jsx)("div",{className:"flex justify-center mb-6",children:(0,r.jsx)(i.default,{src:"/logo2.svg",alt:"EncontreAqui",width:160,height:80,className:"h-20 w-auto",priority:!0})}),(0,r.jsxs)("div",{className:"text-center mb-6",children:[(0,r.jsx)(o.A,{className:"w-12 h-12 text-accent-400 mx-auto mb-3"}),(0,r.jsx)("h1",{className:"text-2xl font-bold text-white mb-2",children:"Verificar Telefone"}),(0,r.jsx)("p",{className:"text-white/70",children:C?"Digite o c\xf3digo enviado para ".concat(q):"Vamos enviar um c\xf3digo SMS para ".concat(q)})]}),E&&(0,r.jsxs)("div",{className:"mb-6 p-4 bg-red-500/20 border border-red-500/30 rounded-xl flex items-start gap-3",children:[(0,r.jsx)(d.A,{className:"w-5 h-5 text-red-400 mt-0.5 flex-shrink-0"}),(0,r.jsx)("p",{className:"text-red-200 text-sm",children:E})]}),!C&&(0,r.jsx)("div",{className:"mb-6 flex justify-center",children:(0,r.jsx)("div",{id:"recaptcha-container"})}),C&&(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("label",{className:"block text-white/70 text-sm mb-2",children:"C\xf3digo de 6 d\xedgitos"}),(0,r.jsx)("input",{type:"text",value:T,onChange:e=>F(e.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",maxLength:6,className:"w-full px-4 py-4 bg-white/10 border border-white/20 rounded-xl text-white text-center text-2xl tracking-[0.5em] placeholder-white/30 focus:outline-none focus:ring-2 focus:ring-accent-500 focus:border-transparent"})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[C?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:J,disabled:k||T.length<6,className:"w-full py-4 bg-accent-500 hover:bg-accent-600 text-primary-900 font-semibold rounded-xl shadow-lg shadow-accent-500/25 transition-all duration-200 flex items-center justify-center gap-2 disabled:opacity-50",children:k?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"w-5 h-5 border-2 border-primary-900 border-t-transparent rounded-full animate-spin"}),"Verificando..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(h.A,{className:"w-5 h-5"}),"Validar C\xf3digo"]})}),(0,r.jsx)("button",{onClick:()=>H(!0),disabled:N||I>0,className:"w-full py-3 bg-white/10 hover:bg-white/20 text-white font-medium rounded-xl border border-white/20 transition-all duration-200 flex items-center justify-center gap-2 disabled:opacity-50",children:I>0?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(m.A,{className:"w-4 h-4"}),"Reenviar em ",I,"s"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(m.A,{className:"w-4 h-4"}),"Reenviar C\xf3digo"]})})]}):(0,r.jsx)("button",{onClick:()=>H(!1),disabled:N||!R,className:"w-full py-4 bg-accent-500 hover:bg-accent-600 text-primary-900 font-semibold rounded-xl shadow-lg shadow-accent-500/25 transition-all duration-200 flex items-center justify-center gap-2 disabled:opacity-50",children:N?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"w-5 h-5 border-2 border-primary-900 border-t-transparent rounded-full animate-spin"}),"Enviando..."]}):R?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.A,{className:"w-5 h-5"}),"Enviar C\xf3digo SMS"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.A,{className:"w-5 h-5"}),"Aguarde o reCAPTCHA..."]})}),(0,r.jsxs)("button",{onClick:()=>{t.push("/cadastro/verificar-email")},className:"w-full py-3 text-white/70 hover:text-white transition-colors flex items-center justify-center gap-2",children:[(0,r.jsx)(p.A,{className:"w-4 h-4"}),"Voltar"]})]})]}),(0,r.jsxs)("p",{className:"text-center mt-6 text-white/70",children:["J\xe1 tem uma conta?"," ",(0,r.jsx)(c(),{href:"/login",className:"text-accent-400 hover:text-accent-300 font-medium",children:"Fazer login"})]})]})})}},5626:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(1847).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},6132:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(1847).A)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},7910:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(1847).A)("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},9141:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(1847).A)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]])},9559:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(1847).A)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])}},e=>{e.O(0,[563,619,697,239,380,441,255,358],()=>e(e.s=3219)),_N_E=e.O()}]);